{\rtf1\ansi\ansicpg1252\cocoartf1265\cocoasubrtf210
{\fonttbl\f0\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww10800\viewh8400\viewkind0
\deftab720
\pard\pardeftab720

\f0\fs24 \cf0 @create Parent Shuttle=10\
@lock Parent Shuttle=#0\
&LAUNCH Parent Shuttle=@tr v(credit_bureau)/deactivate_shuttle = v(source), v(destination), num(me);@dolist lcon(me) = \{@swi/first [type(##)]+[match(v(passenger_list), ##)] = PLAYER+0,\{@pemit ## = An official politely escorts you from the shuttle after determining that you are not on the passenger list.;drop ##\};@swi ## = first(revwords(lcon(me))),\{@wait 15 = @tr me/emit_one;@tr me/launch_emit;&state me = in space;@lock/leavelock me = #0\}\};@pemit/contents me = An official discreetly checks the occupants of the shuttle against the passenger list.;\
&EMIT_ONE Parent Shuttle=@pemit/contents me = The shuttle shudders with the vibration of its powerful crystalline drive as it launches from the bay.;@wait 30 = @tr me/emit_two\
&LAUNCH_EMIT Parent Shuttle=@emit/room A shuttle launches from its bay.;space\
&EMIT_TWO Parent Shuttle=@pemit/contents me = You rise slightly in your seat with the weightlessness of space and are held securely by your buckle.;@wait 30 = @tr me/emit_three\
&EMIT_THREE Parent Shuttle=@pemit/contents me = You settle comfortably back into the long and rather tedious journey.;@wait 30 = @tr me/emit_four\
&EMIT_FOUR Parent Shuttle=@pemit/contents me = You awake from a slight doze at the feel of the shuttle descending and slowing with some retroblasts.;@wait 30 = @tr me/emit_five\
&EMIT_FIVE Parent Shuttle=@pemit/contents me = The shuttle vibration ceases, signalling arrival on [iter(v(destination), capstr(##))].;@name me = Shuttle arriving from [iter(edit(secure(v(source)), #, '), capstr(##))];@tel me = v(destination);&state me = landed at destination;@wait 1 = @emit/room A shuttle sets down lightly with a quiet hum of its crystal drive.;@wait 30 = @tr me/emit_six;\
&OPEN_AIRLOCK_EMIT Parent Shuttle=@pemit/contents me = The shuttle opens its airlock and the pressure pops in your ears as the entry is unsealed.;@lock/leavelock me = v(shuttle_lock)\
&MASTER_PLCU Parent Shuttle=#99\
&EMIT_SIX Parent Shuttle=@pemit/contents me = The Shuttle pilot announces over the intercom system, "[get_eval(v(plcu)/greeting)]";@wait 10 = @tr me/open_airlock_emit;@wait 1800=@tr me/connect_check\
@Lfail Parent Shuttle=[switch(v(state),in space,The Shuttle pilot has not given permission for anyone to leave the shuttle yet.,\{You are still buckled in, you must 'unbuckle' yourself before you can leave.\})]\
@Oenter Parent Shuttle=[switch(type(%#),PLAYER,passes through the portal into the shuttle,is placed into the cargo area of the shuttle destined for%b[iter(v(destination), capstr(##))])].\
@Oxenter Parent Shuttle=[switch(type(%#),PLAYER,passes through the portal into the shuttle,is placed into the cargo area of the shuttle destined for%b[iter(v(destination), capstr(##))])].\
@Enter Parent Shuttle=You pass through the portal and into the shuttle destined for [iter(v(destination), capstr(##))].\
@Leave Parent Shuttle=You step through the portal and onto the debarkation area on%b[iter(v(destination), capstr(##))].\
@Oleave Parent Shuttle=[switch(type(%#),PLAYER,steps through the portal and onto the debarkation area on [iter(v(destination), capstr(##))].,is removed and placed on dockets in the cargo area on%b[iter(v(destination), capstr(##))])].\
@Oxleave Parent Shuttle=[switch(type(%#),PLAYER,steps out of a Shuttle.,is removed from a Shuttle and placed on dockets in the cargo area.)]\
@Fail Parent Shuttle=Heh. You and which crane?\
@Aleave Parent Shuttle=@lock/uselock me=me [iter(lcon(me),|##)];&buckled_%# me=;@edit me/shuttle_lock=&!%#,;@swi v(state)=in space,,\{@lock/leave me=v(shuttle_lock)\};@swi v(state)=pre launch,,\{&anybody_left me=no;@swi words(lcon(me))=0,\{@tr me/check_if_empty\};@dolist lcon(me)=\{@swi [type(##)]+[hasflag(##, connect)]=PLAYER+1,\{&anybody_left me=yes\};@swi match(lcon(me), ##) = words(lcon(me)),\{@tr me/check_if_empty\}\}\}\
@Aenter Parent Shuttle=@lock/uselock me=me [iter(lcon(me),|##)]; @pemit/contents me= switch(words(v(first_class_%#)), 0,,\{%rA well-dressed attendant leads\'a0%N to\'a0%p seat in the first-class section of the shuttle.\}); @pemit #5521 = adldlfkjad entered shuttle\'a0%#\
&BUCKLE Parent Shuttle=$buckle: @swi words(v(buckled_%#))=0,\{@pemit/contents me=%N securely buckles in.;&buckled_%# me=yes;@edit me/shuttle_lock=$,&!%#;@swi v(state)=in space,,\{@lock/leave me=v(shuttle_lock)\}\},\{@pemit\'a0%#=You are already buckled in.\}\
&UNBUCKLE Parent Shuttle=$unbuckle: @swi words(v(buckled_%#))=0,\{@pemit\'a0%#=You are not currently buckled in.\},\{@swi v(state)=in space,\{@pemit\'a0%#=Unbuckling is not advised at this time.\},\{@pemit/contents me=%N releases the buckle around\'a0%o.;&buckled_%# me=;@edit me/shuttle_lock=&!%#,;@lock/leave me=v(shuttle_lock)\}\}\
&SHUTTLE_LOCK Parent Shuttle=!#0\
@Idesc Parent Shuttle=The inside of the shuttle feels confining. The seats are set close together and there are no ports which allow viewing of the outside of the shuttle. The forward section contains the pilot and is closed off. Each seat is equipped with a sturdy buckle. [switch(v(state),pre launch,All passengers must be 'buckle'ed in before the shuttle will take off.,in space,Please remain buckled during the voyage.,landed at destination,Passengers need to 'unbuckle' before they can leave the shuttle.)][setq(0, iter(lcon(me), switch(words(v(first_class_##)), 0,, ##)))][setq(1, setdiff(lcon(me),\'a0%q0))]%r%rFirst Class compartment:%b%b[switch(words(%q0), 0, empty, iter(%q0, name(##)))]%r%rCoach compartment:%b%b[switch(words(%q1), 0, empty, iter(%q1, name(##)))]\
@Desc Parent Shuttle=This is a shuttlecraft, kept meticulously clean and with a familiar emblem on the nose.%b If you have booked a seat, you may 'board shuttle'.\
&CHECK_IF_READY2 Parent Shuttle=&try_count me=sub(v(try_count), 1);@swi v(at_least_one_passenger)=no,\{@emit/room The dispatcher announces that the shuttle to%b[iter(v(destination), capstr(##))]%b is ready to leave, those who wish to board should do so now.;@swi gte(v(try_count),0)=1,\{@wait 60=@tr me/check_if_ready\},\{@swi words(v(passenger_list))=0,\{@tr v(credit_bureau)/deactivate_shuttle=v(source), v(destination), num(me);\};@dolist v(passenger_list)=\{@pemit ##=The dispatcher announces that the shuttle to%b[capstr(v(destination))]%bhas been cancelled due to no passengers showing up by the departure time. Your money is being refunded.;@tr v(credit_bureau)/exchange_money=v(credit_bureau),##,switch(elock(#8654, ##), 1, get(v(plcu)/landing_fee), 0),\{Shuttle fee refund\};@tr v(credit_bureau)/deactivate_shuttle=v(source), v(destination), num(me);@tr v(credit_bureau)/subtract_money_owed=get(v(plcu)/leader), get(v(plcu)/landing_fee), elock(#8654, ##);&visitors_via_shuttle v(plcu)=sub(get(v(plcu)/visitors_via_shuttle), 1)\};@swi 1 = 1, \{@name me=A shuttlecraft;@emit/room A shuttle launches from its bay.;space;@wait 10=@dest me\}\} \},\{@swi v(any_not_buckled)=no,\{&any_not_buckled me;&at_least_one_passenger me;@tr me/launch;@dolist v(passenger_list)=\{@swi match(lcon(me), ##)=0,\{@pemit ##=The dispatcher announces that the shuttle to%b[capstr(v(destination))] has left. Your money is being refunded%bsince you missed the flight.;@tr v(credit_bureau)/subtract_money_owed=get(v(plcu)/leader), get(v(plcu)/landing_fee), elock(#8654, ##);@tr v(credit_bureau)/exchange_money=v(credit_bureau), ##, switch(elock(#8654, ##), 1, get(v(plcu)/landing_fee), 0), \{Shuttle fee refund\};&visitors_via_shuttle [v(plcu)]=sub(get(v(plcu)/visitors_via_shuttle), 1)\},\{@swi hasflag(##, connect)=0,\{@tr v(credit_bureau)/exchange_money=v(credit_bureau), ##, switch(elock(#8654, ##), 1, get(v(plcu)/landing_fee), 0), \{Shuttle fee refund\};@tr v(credit_bureau)/subtract_money_owed=get(v(plcu)/leader), get(v(plcu)/landing_fee), elock(#8654, ##);&visitors_via_shuttle [v(plcu)]=sub(get(v(plcu)/visitors_via_shuttle), 1);@tel ##=home\}\}\}\},\{@pemit/contents me=The pilot announces that the shuttle is ready for launch and is now waiting for all passengers to be buckled in. (type 'buckle' if you have not ready done so);@swi gte(v(try_count),0)=1,\{@wait 60=@tr me/check_if_ready\},\{@unlock/leavelock me;@swi words(v(passenger_list))=0,\{@tr v(credit_bureau)/deactivate_shuttle=v(source), v(destination), num(me);\};@dolist v(passenger_list)=\{@pemit ##=The dispatcher announces that the shuttle to%b[capstr(v(destination))] has been cancelled due to a temperamental pilot stalking off after the passengers refused to buckle in. Your money is being refunded.;@tr v(credit_bureau)/exchange_money=v(credit_bureau),##,switch(elock(#8654, ##), 1, get(v(plcu)/landing_fee), 0), \{Shuttle fee refund\};@tr v(credit_bureau)/deactivate_shuttle=v(source), v(destination), num(me);@tr v(credit_bureau)/subtract_money_owed=get(v(plcu)/leader), get(v(plcu)/landing_fee), elock(#8654, ##);&visitors_via_shuttle [v(plcu)]=sub(get(v(plcu)/visitors_via_shuttle), 1);drop ##\};@swi 1 = 1, \{@name me=A shuttlecraft;@emit/room A shuttle launches from its bay.;space;@wait 10=@dest me\}\}\}\}\
&CHECK_IF_READY Parent Shuttle=@swi gt(v(departure_time), secs())=1,\{@wait sub(v(departure_time), secs())=@tr me/check_if_ready\},\{&at_least_one_passenger me=no;&any_not_buckled me=no;@swi words(lcon(me))=0,\{@tr me/check_if_ready2\};@dolist lcon(me)=\{@swi/first [type(##)]+[neq(match(v(passenger_list), ##),0)]+[hasflag(##, connect)]=PLAYER+1+1,\{&at_least_one_passenger me=yes;@swi words(v(buckled_##))=0,\{&any_not_buckled me=yes\}\};@swi ## = first(revwords(lcon(me))),\{@tr me/check_if_ready2\}\}\}\
&SECURED_TYPE Parent Shuttle=shuttle\
&START_PREPARATIONS Parent Shuttle=@wait sub(v(departure_time), v(start_time))=\{&try_count me=3;@tr me/check_if_ready\};@wait sub(sub(v(departure_time), v(start_time)), 120)=\{@tr #25/check_passenger_list=num(me)\}\
@Efail Parent Shuttle=Sorry, you are not on the passenger list.\
&MASTER_SHUTTLE Parent Shuttle=#85\
@lock/LeaveLock Parent Shuttle=!#0\
&CHECK_IF_EMPTY Parent Shuttle=@swi v(anybody_left)=no,\{@name me=A shuttlecraft;@emit/room A shuttle launches from its bay.;space;@wait 10=@dest me\}\
&CREDIT_BUREAU Parent Shuttle=#25\
@Lalias Parent Shuttle=out;ou;o;back;exit\
@Ealias Parent Shuttle=board shuttle\
&CONNECT_CHECK Parent Shuttle=&anybody_left me=no;@dolist lcon(me)=\{@swi [type(##)]+[hasflag(##,connect)]=PLAYER+1,\{&anybody_left me=yes\}\};@wait 10=@tr me/check_if_empty;@wait 1800=@tr me/connect_check\
@set Parent Shuttle=QUIET\
@set Parent Shuttle=ENTER_OK\
@set Parent Shuttle=SAFE\
@set Parent Shuttle=COMMANDS\
}