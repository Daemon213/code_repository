{\rtf1\ansi\ansicpg1252\cocoartf1265\cocoasubrtf210
{\fonttbl\f0\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;}
\margl1440\margr1440\vieww15480\viewh8400\viewkind0
\deftab720
\pard\pardeftab720

\f0\fs24 \cf0 http://en.wikipedia.org/wiki/Lunar_phase\
\
The phases of the Moon have been given the following names, in sequential order:\
Phase                   Visibility                              (mid-phase)\
New/Dark moon           after sunset                            12 noon (6am to 6pm)\
Waxing crescent moon    afternoon and post-dusk                 3 pm (9am to 9pm)\
Waxing half moon        afternoon and early night               6 pm (noon to midnight)\
Waxing gibbous moon     late afternoon and most of night        9 pm (3pm to 3am)\
Full moon               sunset to sunrise (all night)           12 midnight (6pm to 6 am)\
Waning gibbous moon     most of night and early morning         3 am (9pm to 9am)\
Waning half moon        late night and morning                  6 am (midnight to noon)\
Waning crescent moon    pre-dawn and morning                    9 am (3am to 3pm)\
\
@@ I created this as an alternative to Keran's bulky time and weather package.\
@@ It's much more compact as a single object and is less demanding of system resources.\
@@ It has reasonably accurate moon and tide functions. The weather code could use improving but does work. \
@@\
@@ Time: Counts on real server time to calculate leap year, daylight savings, and other oddities.\
@@ It works by simply changing the rate time is calculated.\
@@ To simplify things there's a 12 hour day/night cycle. It can be adjusted slightly by using either the 6am \
@@ or 7am versions.\
@@\
@@ Tide: A typical semi-diurnal tide like the Atlantic ocean (this means two high and low tides a day). Change 44160 \
@@ if you want to make it regular a regular diurnal (single high and low tide a day) tide such as you might find in \
@@ the Pacific.\
@@\
@@ Moon: I'm pretty happy with this set of calculations.\
@@ Built using wikipedia information on the moon phases and times: http://en.wikipedia.org/wiki/Lunar_phase\
@@ The Real Moon version will calculate the phase of the moon correctly and the moon will be visible in the day \
@@ or night sky as appropriate to the phase. The phases are uneven. There is only one night of full or new moon per \
@@ lunar month, while the other phases are each multiple days. Additionally, the rise and set times will gradually\
@@ scale. The real moon stuff is probably more complicated than it needs to be, but MU servers on \
@@ modern computers should be able to handle the calculations without lag.\
@@\
@@ The WoD version is meant for World of Darkness games. Full and new moon get extra days for the appropriate \
@@ Werewolf auspices. \
@@\
@@ Weather: The weather code is old and written by someone else. I've only minimally patched it. You need to set up a loop\
@@ to make MAKE-WEATHER trigger occasionally (about once an hour is probably good).\
@@  I add it to my Myrrdin's MUSHCron code queue. If you don't loop MAKE-WEATHER, the weather will never change!\
\
@create Gwen's Compact Time Weather Moon Tide Object=10\
@Desc Gwen's Compact Time Weather Moon Tide Object=This is a collection of time, moon, weather, and tide functions. The startup on this object must be triggered at every startup of the server. As such, the startup on #1 must include the appropriate trigger or the server must be configured so that wizards can use @function. This decision is a matter of preference.%R%R[iter(setdiff(lattr(me),Desc),ljust(##,18))]\
@Startup Gwen's Compact Time Weather Moon Tide Object=@dol lattr(me/fn_*)=@function/priv/preserve after(##,FN_)=me/##;\
&TIME-VERSION Gwen's Compact Time Weather Moon Tide Object=5.0\
&TIME-CREDITS Gwen's Compact Time Weather Moon Tide Object=Time, moon, and tide code completely written by Gwen Morse with help from Regan at many MUs, and Gary Weiner. Inspired by Keran@Keranset Island, but none of Keran's code remains. Weather code from unknown original source (posted to softcode mailing list), also torn apart and rewritten by Gwen Morse. This may be freely distributed as long as the credits stay intact.\
&TIME-BEGINS Gwen's Compact Time Weather Moon Tide Object=469916736\
&FN_VSECS Gwen's Compact Time Weather Moon Tide Object=[mul(sub(secs(),v(TIME-BEGINS)),1.5)]\
&FN_VTIME Gwen's Compact Time Weather Moon Tide Object=[convsecs(vsecs())]\
&TIME_OF_DAY Gwen's Compact Time Weather Moon Tide Object=[switch(hour(),06,dawn,18,dusk,switch(div(mod(vsecs(),86400),25200),0,night,1,morning,2,afternoon,3,evening,broken code))]\
&AM6_TIME_OF_DAY Gwen's Compact Time Weather Moon Tide Object=[switch(hour(),05,dawn,17,dusk,switch(div(mod(vsecs(),86400),21600),0,night,1,morning,2,afternoon,3,evening,broken code))]\
&AM7_TIME_OF_DAY Gwen's Compact Time Weather Moon Tide Object=[switch(hour(),06,dawn,18,dusk,switch(div(mod(vsecs(),86400),25200),0,night,1,morning,2,afternoon,3,evening,broken code))]\
&DARK-LIGHT Gwen's Compact Time Weather Moon Tide Object=[switch(u(time_of_day),morning,light,afternoon,light,evening,dark,night,dark)]\
&FN_TIMEOFDAY Gwen's Compact Time Weather Moon Tide Object=[u(time_of_day)]\
&FN_DATE Gwen's Compact Time Weather Moon Tide Object=[extract(vtime(),1,3)] [extract(vtime(),5,1)]\
&FN_HOUR Gwen's Compact Time Weather Moon Tide Object=[extract(clock(),1,1,:)]\
&FN_CLOCK Gwen's Compact Time Weather Moon Tide Object=[extract(vtime(),4,1)]\
&TIDE_HEIGHT Gwen's Compact Time Weather Moon Tide Object=switch(div(mul(10,mod(sub(secs(),v(time-begins)),44160)),44160),0,rising,1,falling,2,falling,3,falling,4,falling,5,falling,6,rising,7,rising,8,rising,9,rising,broken code)\
&TIDE_MOVEMENT Gwen's Compact Time Weather Moon Tide Object=switch(div(mul(10,mod(sub(secs(),v(time-begins)),44160)),44160),0,high,1,high,2,medium,3,medium,4,medium,5,low,6,low,7,medium,8,medium,9,medium,broken code)\
&FN_TIDE Gwen's Compact Time Weather Moon Tide Object=[u(tide_movement)] and [u(tide_height)]\
&FN_MOON Gwen's Compact Time Weather Moon Tide Object=switch(modulo(sub(idiv(vsecs(),86400),7),29),0,New,7,Waxing Half,14,Full,21,Waning Half,switch(idiv(modulo(sub(idiv(vsecs(),86400),7),29),7),0,Waxing Crescent,1,Waxing Gibbous,2,Waning Gibbous,Waning Crescent))\
&FN_MOONUP Gwen's Compact Time Weather Moon Tide Object=[switch(or(and(gte(modulo(vsecs(),86400),modulo(add(21600,[mul(modulo(sub(idiv(vsecs(),86400),7),29),2979)]),86400)),lte(modulo(vsecs(),86400),add(modulo(add(21600,[mul(modulo(sub(idiv(vsecs(),86400),7),29),2979)]),86400)),43200)),and(lte(modulo(vsecs(),86400),modulo(add(74800,[mul(modulo(sub(idiv(vsecs(),86400),7),29),2979)]),86400)),gte([mul(modulo(sub(idiv(vsecs(),86400),7),29),2979)],21600))),0,set,1,risen,broken code)]\
&MOON-PHASE Gwen's Compact Time Weather Moon Tide Object=[moon()]\
&WOD_MOON Gwen's Compact Time Weather Moon Tide Object=[switch(div(mod(vsecs(),2419200),302400),0,New,1,Waxing Crescent,2,Waxing Half,3,Waxing Gibbous,4,Full,5,Waning Gibbous,6,Waning Half,7,Waning Crescent)]\
&REAL_MOON Gwen's Compact Time Weather Moon Tide Object=switch(modulo(sub(idiv(vsecs(),86400),7),29),0,New,7,Waxing Half,14,Full,21,Waning Half,switch(idiv(modulo(sub(idiv(vsecs(),86400),7),29),7),0,Waxing Crescent,1,Waxing Gibbous,2,Waning Gibbous,Waning Crescent))\
&MOON-ADJECTIVE Gwen's Compact Time Weather Moon Tide Object=[switch(u(FN_MOON), New, black, Waxing Crescent, faint, first quarter, dim, Waxing Gibbous, bright, Full, brilliant, Waning Gibbous, bright, last quarter, dim, Waning Crescent, faint)]\
&FN_SEASON Gwen's Compact Time Weather Moon Tide Object=[switch(mid(vtime(), 4, 3), Jan, WINTER, Feb, WINTER, Mar, switch(gte(mid(vtime(), 8, 2),21),1,SPRING,WINTER), Apr, SPRING, May, SPRING, Jun, switch(gte(mid(vtime(), 8, 2),21),1,SUMMER,SPRING),Jul, SUMMER, Aug, SUMMER, Sep, switch(gte(mid(vtime(), 8, 2),21),1,AUTUMN,SUMMER), Oct, AUTUMN, Nov, AUTUMN, Dec, switch(gte(mid(vtime(), 8, 2),21),1,WINTER,AUTUMN))]\
&DAT_MONTHS Gwen's Compact Time Weather Moon Tide Object=Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec\
&DAT_SEASON Gwen's Compact Time Weather Moon Tide Object=10 10 15 20 20 28 28 25 20 20 15 10\
&DESC_WEATHER Gwen's Compact Time Weather Moon Tide Object=[u(fun_describe_weather)] [u(fun_describe_wind)]\
&SET_TEMPERATURE Gwen's Compact Time Weather Moon Tide Object=&temperature me=[sub(add(extract(v(dat_season),member(v(dat_months),extract(vtime(),2,1)),1),u(fun_temperature_by_hour)),mul(4,v(wind-force)))];@notify me\
&WEATHER Gwen's Compact Time Weather Moon Tide Object=It's a chilly 15 degrees C (59 F), with clear skies. There is a gentle breeze blowing from the south-east.\
&UPDATE-WIND Gwen's Compact Time Weather Moon Tide Object=&old-wind-dir me=[setq(1,v(wind-dir))]%q1;&wind-dir me=[setq(2,u(fun_adjust,%q1,4))][switch([lt(%q2,0)]:[gt(%q2,3)],1:0,3,0:1,0,%q2)];&old-wind-force me=[setq(1,v(wind-force))]%q1;&wind-force me=[setq(2,u(fun_adjust,%q1,4))][switch([lt(%q2,0)]:[gt(%q2,6)],1:0,0,0:1,6,%q2)];&old-pressure me=[setq(1,v(pressure))]%q1;&pressure me=[setq(2,u(fun_adjust,%q1,3))][switch([lt(%q2,0)]:[gt(%q2,15)],1:0,0,0:1,15,%q2)]\
&OLD-WIND-DIR Gwen's Compact Time Weather Moon Tide Object=3\
&OLD-WIND-FORCE Gwen's Compact Time Weather Moon Tide Object=2\
&WIND-FORCE Gwen's Compact Time Weather Moon Tide Object=3\
&WIND-DIR Gwen's Compact Time Weather Moon Tide Object=3\
&PRESSURE Gwen's Compact Time Weather Moon Tide Object=14\
&OLD-PRESSURE Gwen's Compact Time Weather Moon Tide Object=15\
&MAKE-WEATHER Gwen's Compact Time Weather Moon Tide Object=&temperature me=[sub(add(extract(v(dat_season),member(v(dat_months),extract(vtime(),2,1)),1),u(fun_temperature_by_hour)),mul(u(wind-chill,u(fun_temperature_by_hour)),v(wind-force)))];&weather me=[u(desc_weather)];@tr me/update-wind\
&WIND-CHILL Gwen's Compact Time Weather Moon Tide Object=0.5\
&DAT_SEASON-OLD Gwen's Compact Time Weather Moon Tide Object=-17 -7 5 10 18 25 28 30 18 7 -10 -15\
&FN_WEATHER Gwen's Compact Time Weather Moon Tide Object=[get(me/weather)]\
&FUN_PRECIP_TYPE Gwen's Compact Time Weather Moon Tide Object=[switch([setq(0,v(temperature))][lt(%q0,-2)]:[lt(%q0,4)]:[lt(%q0,5)],1:*,snow,0:1:*,sleet,0:0:1:*,hail,rain)]\
&FUN_TEMPERATURE_BY_HOUR Gwen's Compact Time Weather Moon Tide Object=[extract(-1 -2 -3 -4 -2 -1 0 1 2 3 4 5 6 5 5 4 4 3 3 2 2 1 0 0,add(extract(edit(vtime(),:,space()),4,1),1),1)]\
&FUN_WSTRENGTH Gwen's Compact Time Weather Moon Tide Object=[extract(faint breeze|gentle breeze|strong breeze|light wind|moderate wind|gusty wind|strong wind|high wind|godawful gale|terrible gale \\(all temporary structures flattened\\, cars rolled\\, trees uprooted and thrown against buildings\\)|,v(wind-force),1,|)]\
&FUN_WDIR Gwen's Compact Time Weather Moon Tide Object=[extract(north|north-east|east|south-east|south|south-west|west|north-west|,add(v(wind-dir),1),1,|)]\
&FUN_DESCRIBE_WIND Gwen's Compact Time Weather Moon Tide Object=[switch(v(wind-force),0,The air is still,There is a [u(fun_wstrength)] blowing from the [u(fun_wdir)])].\
&FUN_DESCRIBE_WEATHER Gwen's Compact Time Weather Moon Tide Object=It's a [u(fun_coldwords,v(temperature))] [v(temperature)] degrees C ([add(div(mul([get(me/temperature)],9),5),32)] F), and [u(fun_desc_precip)].\
&FUN_DESC_PRECIP Gwen's Compact Time Weather Moon Tide Object=[extract([u(fun_precip_type)]ing incredibly heavily|[u(fun_precip_type)]ing heavily|[u(fun_precip_type)]ing thickly|[u(fun_precip_type)]ing|[u(fun_precip_type)]ing lightly|[u(fun_precip_type)]ing lightly|deeply overcast|cloudy|dim cloudy skies|light cloudy skies|bright cloudy skies|bright cloudy skies|cloudy skies|cloudy skies|clear skies|clear skies|clear skies|clear skies|clear skies|clear skies|,add(1,v(pressure)),1,|)]\
&FUN_COLDWORDS Gwen's Compact Time Weather Moon Tide Object=[switch([lt(%0,0)]:[lt(%0,0)]:[lt(%0,8)]:[lt(%0,16)]:[lt(%0,27)]:[lt(%0,32)],1:*,bitterly cold,0:1:*,freezing,0:0:1:*,cold,0:0:0:1:*,chilly,0:0:0:0:1:*,comfortable,0:0:0:0:0:1,warm,hot)]\
&FUN_ADJUST Gwen's Compact Time Weather Moon Tide Object=[switch(add(rand(%1),1),2,sub(%0,1),3,add(%0,1),%0)]\
&FUN_ADJUST2 Gwen's Compact Time Weather Moon Tide Object=[switch(rand(%1),2,sub(%0,1),3,add(%0,1),4,add(%0,1),5,add(%0,1),%0)]\
&TEMPERATURE Gwen's Compact Time Weather Moon Tide Object=15\
&TRIGGER-AT-DAWN Gwen's Compact Time Weather Moon Tide Object=[switch(match(get(me/fun_desc_precip),*clear*, TIME: The stars in the east begin to look washed out as the sapphire night sky pales at dawn.,cloudy, TIME: A faint sheen touches the clouds in the sapphire night sky to the east as dawn approaches.,*grey*, TIME: The grey sky pales in the east as dawn approaches.,*snow*, \{TIME: The snowy grey sky pales in the east as damp, cold dawn approaches.\},*sleet*, TIME: A faint gleam of dawn touches the eastern sky through the sleet and the cold wind.,*rain*, \{TIME: Through the veils of rain, the clouds to the east pale as dawn approaches.\},TIME: The sky brightens with color as dawn approaches.)]\
&TRIGGER-AT-DUSK Gwen's Compact Time Weather Moon Tide Object=[switch(match(get(me/fun_desc_precip),*clear*, Shadows lengthen and the light turns golden as the sun sinks toward the west signaling the dusk.,*cloudy*, \{TIME: Purple, gold, and vermilion clouds grace the western sky as the sun descends toward the west at dusk.\},*grey*, TIME: The grey sky dims at dusk.,*rain*,TIME: A rainy late afternoon gives way to dusky evening.,*snow*, \{TIME: Through the drifting snowflakes, the translucent pale grey of the sky deepens to dusk.\},*sleet*,TIME: Sleet coats the ground with ice as dusk draws near.,\{TIME: The light begins to fade as the sun sinks towards the west, signaling the transition to dusk.\})]\
@set Gwen's Compact Time Weather Moon Tide Object=INHERIT\
@set Gwen's Compact Time Weather Moon Tide Object=SAFE\
}